\section{Лекция номер 7}
\subsection{Линейные операторы}
\begin{conj}
    Линейный оператор на векторном пространстве $V$ -- линейное отображение из $V$ в $V$.

    $\End V = \Hom(V, V)$ -- множество всех линейных операторов над $V$.
\end{conj}

В этом параграфе подразумевается, что $V$ -- конечномерное линейное пространство над полем $K$.

\begin{theorem-non}
    Пусть $\A \in \End V$. Тогда следующие 3 условия эквивалентны:
    \begin{enumerate}
        \item $\A$ обратим
        \item $\Imm \A = V$
        \item $\Ker \A = 0$
    \end{enumerate}
\end{theorem-non}
\begin{proof} \quad 

    \quad$2 \Leftrightarrow 3:$ очевидно благодаря равенству $\dim \Ker \A + \dim \Imm \A = \dim V$.
    
    \quad$1 \Rightarrow 2, 3:$ очевидно, так как обратимый линейный оператор это биекция.

    \quad$2, 3 \Rightarrow 1:$ из второго пункта следует, что $\A$ сюръективен, из третьего, что инъективен (этот факт доказывался на 3 лекции), следовательно $\A$ биективен, а значит обратим.
\end{proof}

\begin{theorem-non}
    Оператор обратим, если и только если его матрица невырожденная (обратима).
\end{theorem-non}
\begin{proof}
    $\A \in \End V, E$ -- базис $V$, $A = [\A]_E$

    \quad$\Rightarrow:$
    \begin{gather*}
        \A\mathcal{B} = \mathcal{B}\A = \mathcal{E}_V \; \text{(тождественный оператор)} \\
        \Rightarrow [\A\mathcal{B}]_E =  [\A]_E[\mathcal{B}]_E = [\mathcal{B}]_E[\A]_E = E_n \Rightarrow [\A]_E \in GL_n(K)
    \end{gather*}
    \quad$\Leftarrow:$
    \begin{gather*}
        A \in GL_n(K) \\
        \Rightarrow \exists B \in GL_n(K) : AB = BA = E_n \\
        \Rightarrow \exists \mathcal{B} \in \End V : [\mathcal{B}] = B \text{(между матрицами и отображениями есть биекция)} \\
        [\A\mathcal{B}]_E = [\A]_E[\mathcal{B}]_E = AB = E_n \\
        \Rightarrow \A\mathcal{B} = \mathcal{B}\A = \mathcal{E}
    \end{gather*}
\end{proof}

\begin{conj}
    Инвариантное подпространство $W$ векторного пространства $V$ относительно линейного оператора $\A$ - это такое подпространство, что $\A(W) \subset W$.
\end{conj}

\underline{Примеры:}
\begin{enumerate}
    \item Само пространство и нулевое подпространство.
    \item Ядро и образ линейного оператора.
\end{enumerate}

\begin{theorem-non}
    Пусть $\A \in \End V$, $W$ -- инвариантное относительно $\A$ подпространство $V$, $e_1, e_2, \dots, e_m$ -- базис $W$ и $e_{m+1}, e_{m+2}, \dots, e_n$ -- дополнение до базиса $V$.
    Тогда
    \[ [\A]_E =  \begin{pmatrix}
        A_1 & B \\
        0 & A_2
    \end{pmatrix}, \]
    где $A_1 \in M_m(K)$ -- матрица сужения опреатора $\A$ на пространство $W$.
\end{theorem-non}
\begin{proof}
    \begin{gather*}
        \begin{split}
            W \; \text{инвариантно относительно} \; \A &\Leftrightarrow \forall w \in W \;\; \A w \in W\\
            &\Leftrightarrow \A e_1, \A e_2, \dots, \A e_m \in W \\
            &\Leftrightarrow \A e_1, \A e_2, \dots, \A e_m \in \Lin(e_1, e_2, \dots, e_m) \\
            &\Leftrightarrow \text{первые $m$ стобцов содержат 0 в строках $m + 1,\dots, n$, } \\
            & \text{так как коэффициенты при этих базисных векторах равны 0}.
        \end{split}
    \end{gather*}
\end{proof}

\begin{follow}
    Пусть $V = W_1 \oplus W_2$ (прямая сумма; она означает, что $V = W_1 + W_2$ и $W_1 \cap W_2 = \emptyset$)
     и $E_1$ -- базис $W_1$, $E_2$ -- базис $W_2$ (соответственно $E = E_1E_2$ -- базис $V$). 
     Тогда \[ W_1, W_2 \; \text{инвариантны относительно $\A$} \Leftrightarrow [\A]_E = \begin{pmatrix}
         A_1 & 0 \\
         0 & A_2
     \end{pmatrix} \]
\end{follow}

\subsection{Собственные векторы и значения линейного оператора}
\begin{conj}
    Собственным вектором линейного оператора $\A$ называется такой ненулевой вектор $v \in V$, что для некоторого $\lambda \in K$ выполнено $\A v = \lambda v$.

    Собственным значением линейного оператора $\A$ называется такой скаляр $\lambda \in K$, что для некоторого ненулевого вектора $v \in V$ выполнено $\A v = \lambda v$
    (говорят, что в таком случае вектор $v$ принадлежит скаляру $\lambda$).
\end{conj}

Заметим, что данное условие можно переписать так:
\[ \A v = \lambda v \Leftrightarrow (\A - \lambda\mathcal{E}_V)v = 0 \Leftrightarrow v \in \Ker(\A - \lambda\mathcal{E}_V) \]
То есть, если $\lambda$ является собственным значением, то все собственные векторы этого $\lambda$ лежат в $\Ker(\A - \lambda\mathcal{E}_V)$. 
Поэтому это подпространство называют собственным.

Введем важную характеристику этого подпространства.

\begin{conj}
    Геометричекая кратность собственного значения -- размерность, принадлажащего ему собственного подпространства:
    \[ g_\lambda = \dim \Ker(\A - \lambda\mathcal{E}) \]
\end{conj}

\begin{theorem}
    Собственные векторы, принадлежащие разным собственным значениям, линейно независимы.
\end{theorem}

\begin{proof}
    Пусть $v_1, v_2, \dots, v_m$ -- собственные векторы, принадлежащие собственным значениям $\lambda_1, \lambda_2, \dots, \lambda_m$.
    Будем доказывать по индукции.
    
    База $m = 1$: по определению собственного вектора $v_1 \neq 0 \Rightarrow v_1$ -- ЛНС.

    Переход $m - 1 \to m$: предположим, что существует нетривиальная линейная комбинация, которая дает 0:
    \begin{gather}
        \alpha_1v_1 + \alpha_2v_2 \dots + \alpha_mv_m = 0
    \end{gather}
    \quad Сразу заметим, что $\alpha_m \neq 0$, так как в ином случае нарушилось бы ИП. 

    \quad Воспользуемся тем, что образ 0 это 0:
    \begin{gather*}
        \A(\alpha_1v_1 + \alpha_2v_2 \dots + \alpha_mv_m) = 0 \\
        \alpha_1\lambda_1v_1 + \alpha_2\lambda_2v_2 \dots + \alpha_m\lambda_mv_m = 0
    \end{gather*}
    \quad Сделам так, чтобы ушло последнее слагаемое.
    Для этого вычтем выражение $(1)$, домноженное на $\lambda_m$:
    \begin{gather*}
        \alpha_1(\lambda_1 - \lambda_m)v_1 + \alpha_2(\lambda_2 - \lambda_m)v_2 \dots + \alpha_{m - 1}(\lambda_{m - 1} - \lambda_m)v_{m - 1} = 0
    \end{gather*}
    \quad Осталось заметить, что $v_1, v_2, \dots, v_{m - 1}$ -- ЛНС по ИП, и множители $(\lambda_i - \lambda_m) \neq 0$, так как собственные значения различны по условию.
    Следовательно $\alpha_1, \alpha_2, \dots, \alpha_{m-1} = 0$. 
    Но $a_m \neq 0$ и $v_m \neq 0$, следовательно эта комбинация не дает 0, и мы пришли к противоречию.
\end{proof}

\begin{follow}
    Пусть $\lambda_1, \lambda_2, \dots, \lambda_m$ -- собственные значения $\A$, $V_1, V_2, \dots, V_m$ -- соответствующие им собственные подпространства.
    Тогда \[ V_1 + V_2 + \dots + V_m = V_1 \oplus V_2 \oplus \dots \oplus V_m. \] 
    Это означает, что любой вектор из $V_1 + V_2 + \dots + V_m$ единственным образом раскладывается в сумма конкретных векторов этих подпространств.
\end{follow}

\begin{proof}
    От обратного. Пусть \[ v_1 + v_2 + \dots + v_m = v_1' + v_2' + \dots + v_m', \]
    \quad где $v_i, v_i' \in V_i$.
    Тогда \[ \underbrace{(v_1 - v_1')}_{\in V_1} + \underbrace{(v_2 - v_2')}_{\in V_2} + \dots + \underbrace{(v_m - v_m')}_{\in V_m} = 0. \]
    \quad Но тогда по предыдущему предложению все коэффициенты равны 0, а значит $v_i = v_i'$.
\end{proof}

\begin{follow}
    Пусть $\lambda_1, \lambda_2, \dots, \lambda_n$ -- все собственные значения $\A$. 
    Тогда сумма их геометрических кратностей не превосходит размерности $V$:
    \[ g_{\lambda_1} + g_{\lambda_2} + \dots + g_{\lambda_n} \leqslant \dim V \]
\end{follow}
\begin{proof}
    Это очевидно, так как сумма соответствующих собственных пространств будет прямой суммой:
    \[ \dim(V_1 + V_2 + \dots + V_m) 
    = \dim(V_1 \oplus V_2 \oplus \dots \oplus V_m)
    =  g_{\lambda_1} + g_{\lambda_2} + \dots + g_{\lambda_n} \]
    \quad А это то, что нам надо, так как размерность подпространства не превосходит размерности пространства.
\end{proof}
\vspace{5mm}

Особо интресен случай, когда сумма геометрических кратностей в точности равна размерности пространства.
Для этого введем понятие диагонализируемого оператора.
\begin{conj}
    Оператор называется диагонализируемым, если в некотором базисе его матрица диагональная 
    (все элементы, стоящие вне главной диагонали равны 0).
\end{conj}

\begin{theorem-non}
    Для $\A \in \End V$ следующие 3 условия эквивалентны:
    \begin{enumerate}
        \item $\A$ диагонализируем.
        \item В $V$ существует базис из собственных векторов.
        \item Сумма геометрических кратностей всех собственных значений равна размерности пространства.
    \end{enumerate} 
\end{theorem-non}

\begin{proof} \quad

    \quad$1 \Rightarrow 2:$ Если $\A$ диагонализируем, то на главной диагноли как раз будут стоять собственные значения.
    
    \quad$2 \Rightarrow 1:$ При разложении по базису в каждом столбце будет повляться только соответствующее собственное значение.

    \quad$1 \Rightarrow 3:$ Матрица оператора имеет следующий вид:
    \begin{gather*}
        [\A]_E = \begin{pmatrix}
            \beta_1 & 0 & 0 & \dots & 0 & \\
            0 & \beta_2 & 0 & \dots & 0 & \\
            \dots & \dots & \dots & \dots & \dots \\
            0 & 0 & 0 & \dots & \beta_n
        \end{pmatrix}
    \end{gather*}
    \quad Рассмотрим скаляр $\lambda$. 
    Чтобы он был собственным значением, оператор $(A - \lambda\mathcal{E}_V)$ должен иметь нетривиально ядро. 
    Тогда согласно самому первому предложению этой лекции, он должен быть необратим, то есть иметь вырожденную матрицу.
    Посмотрим на его матрицу:
    \begin{gather*}
        [\A - \lambda\mathcal{E}_V]_E = \begin{pmatrix}
            \beta_1 - \lambda & 0 & 0 & \dots & 0 & \\
            0 & \beta_2 - \lambda & 0 & \dots & 0 & \\
            \dots & \dots & \dots & \dots & \dots \\
            0 & 0 & 0 & \dots & \beta_n - \lambda
        \end{pmatrix}
    \end{gather*}
    \quad Чтобы она была вырожденной, $\lambda$ должна совпасть с одной из $\beta_i$. 
    Таким образом, \[ \lambda - \text{собственное значение} \Leftrightarrow \lambda \in \{\beta_1, \beta_2, \dots, \beta_n \}  \]
    \quad Теперь поймем, какая кратность будет у такого собственного значения $\lambda$.
    Заметим, что если значение в $i$-том столбце совпало с $\lambda$, то есть что $\beta_i = \lambda$, то этот столбец в матрице $[\A - \lambda\mathcal{E}_V]_E$ будет нулевым.
    То есть некоторые столбцы в матрице $[\A - \lambda\mathcal{E}_V]_E$ будут нулевыми, а некоторые нет.
    Так вот утверждается, что $g_\lambda$ будет в точности равно количеству нулевых столбцов.
    Это так потому что базисные векторы, которые не зануляются, очевидно не будут образующими ядра.

    \quad Итак, разные $\lambda$ будут занулять разные столбцы и в итоге сумма по $g_\lambda$ будет равна $n$ -- размерности пространства.

    $\quad 3 \Rightarrow 2:$ Пусть $V_i$ -- собственное подпространство $i$-того собственного значения.
    По предыдущим предложениям мы знаем, что \[ \dim(V_1 + V_2 + \dots + V_m) 
    = \dim(V_1 \oplus V_2 \oplus \dots \oplus V_m)
    =  \underbrace{g_{\lambda_1} + g_{\lambda_2} + \dots + g_{\lambda_n}}_{ = n} \]
    \quad Только размерность самого пространства равна $n$, следовательно $V_1 \oplus V_2 \oplus \dots \oplus V_m = V$. 
    Объединив базисы $V_1, V_2, \dots, V_m$, мы получим искомый базис $E$, который будет состоять из собственных векторов.
\end{proof}

\vspace{5mm}

Чтобы исследовать собственные значения, нам понадобится такое важное понятие как характеристический многочлен.

\subsection{Характеристический многочлен}
Опять воспользуемся тем фактом, что значение $\lambda$ собственное тогда и только тогда, когда $\Ker(\A - \lambda\mathcal{E}) \neq 0$.
Мы знаем, что это равносильно тому, что соответствующая матрица в любом базисе будет вырожденной, то есть иметь нулевой определитель: \[ |A - \lambda E_n| = 0 \]
Здесь $A = [\A]_E$ для какого-то базиса $E$.

Посмотрим на эту матрицу:
\begin{gather*}
    \begin{pmatrix}
        a_{11} - \lambda & a_{12} & \dots & a_{1n} \\
        a_{21} & a_{22} - \lambda  & \dots & a_{2n} \\
        \dots & \dots & \dots & \dots \\
        a_{n1} & a_{n2} & \dots & a_{nn} - \lambda 
    \end{pmatrix}
\end{gather*}
Здесь $a_{ij}$ -- соответствующие элементы матрицы $A$.

Давайте честно распишем ее определитель и воспользуемся тем фактом, что он равен 0.
Получится какой-то многочлен от $\lambda$.
Он и называется характеристическим многочленом.

Например, для какой-то матрицы $A$ порядка 2 характеристический многочлен будет следующим:
\begin{gather*}
    \begin{vmatrix}
        a_{11} - \lambda & a_{12} \\
        a_{21} & a_{22} - \lambda
    \end{vmatrix} = 0 \\
    (a_{11} - \lambda)(a_{22} - \lambda) - a_{12}a_{21} = 0 \\
    \lambda^2 - (a_{11} + a_{22})\lambda + a_{11}a_{22} - a_{12}a_{21} = 0
\end{gather*}

Введем формальное определение.
\begin{conj}
    Характеристический многочлен матрицы $A \in M_n(K)$ -- это многочлен от $x$ вида $\chi_A = |A - xE_n|$.
\end{conj}

Зафиксируем очевидное, но важное свойство характеристического многочлена.
\begin{lemma}
    Пусть $A \in M_n(K)$ и $\lambda \in K$. Тогда \[ (A - \lambda E_n) \in GL_n(K) \Leftrightarrow \chi_A(\lambda) \neq 0 \]
\end{lemma}
\begin{proof}
    \[ (A - \lambda E_n) \in GL_n(K) \Leftrightarrow |A - \lambda E_n| \neq 0 \Leftrightarrow \chi_A(\lambda) \neq 0 \]
\end{proof}

\begin{conj}
    Характеристический многочлен оператора -- характеристический многочлен матрицы оператора в каком-либо базисе.
\end{conj}
То есть утверждается, что выбор базиса особой роли не играет.
Проверим это.

\quad Зафиксируем 2 базиса: $E$ и $E'$. 
Мы знаем, что если $C$ -- матрица перехода между $E$ и $E'$, то имеет место равенство \[ [\A]_{E'} = C^{-1}[\A]_EC \]
\quad Распишем характеристические многочлены:
\begin{gather*}
    \begin{split}
        \chi_{[A]_{E'}} &= \chi_{C^{-1}[\A]_EC} \\
        &= |C^{-1}[\A]_EC - xE_n| \\
        &= |C^{-1}[\A]_EC - xCC^{-1}| \\
        &= |C^{-1}[\A]_EC - CxC^{-1}| \; \text{(нам все равно где писать $x$)} \\
        &= |C^{-1}([\A]_E - xE_n)C| \\
        &= |C^{-1}| * |[\A]_E - xE_n| * |C| \; \text{(формула определителя произведения)}\\
        &= |C^{-1}| * \chi_{[A]_E} * |C| = \chi_{[A]_E}
    \end{split}
\end{gather*}

В общем случае коэффициенты характеристического многочлена принимают произвольные значения, но все-таки про некоторые их них мы можем кое-что сказать: 
\begin{itemize}
    \item При $x^n$ будет очевидно коэффициент $(-1)^n$
    \item При $x^{n-1}$ будет коэффициент $Tr A(-1)^{n-1}x^{n-1}$. 
    Тут надо понять, что $x^{n-1}$ может получиться только из произведения элементов на главной диагонали. 
    Действительно, если мы возьмем один элемент не с диагонали, то нам придется взять еще один не с диагонали, и нужную степень мы уже не получим.
    В каждом из $n$ множителей вида $(a_{ii} - x)$ в произведение мы можем взять либо $a_{ii}$, либо $-x$.
    Мы возьмем $(n - 1)$ раз $(-x)$ и произвольную $a_{ii}$.
    Легко видеть, что получится необходимая формула.
    \item Свободный член получается при подстановке $x = 0$, следовательно, он равен $|A|$.
\end{itemize}

\vspace{5mm}

Мы уже поняли, что \[ \lambda - \text{собственное значение} \Leftrightarrow \chi_{\A}(\lambda) = 0 \]
У корня многочлена всегда есть кратность, поэтому логичным образом вытекает следующее определение.
\begin{conj}
    Алгебраическая кратность собственного значения -- кратность этого значения как корня характеристического многочлена.

    Обозначается как $a_\lambda$.
\end{conj}

\begin{theorem-non}
    Пусть $W$ -- инвариантное относительно $\A$ подпространство. \\
    Тогда $\chi_{\A|_W}$ делит $\chi_{\A}$.
\end{theorem-non}
\begin{proof}
    Как мы знаем, выбор базиса на характеристический многочлен не влияет, поэтому давайте выберем тот, который содержит базис $W$:
    \begin{gather*}
        E_1 - \text{базис $W$} \\
        E = E_1E_2 - \text{базис $V$}
    \end{gather*}
    \quad Тогда по одному из предложений в параграфе 7.1 матрица оператора $\A$ примет вид:
    \[ [\A]_E = \begin{pmatrix}
        A_1 & * \\
        0 & A_2
    \end{pmatrix}, \]
    \quad где $A_1 = [\A|_W]_E$.
    
    \quad Посчитаем характеристический многочлен с помощью формулы определителя блочно-треугольной матрицы:
    \begin{gather*}
        \chi_{\A} = |[\A]_E - xE_n| = |A_1 - xE_m|*|A_2 - xE_{n-m}| = \chi_{A_1} * \chi_{A_2} = \chi_{\A|_W} * \chi_{A_2} \\
        \Rightarrow \chi_{\A|_W} | \, \chi_{\A}
    \end{gather*}
\end{proof}

\begin{follow}
    Геометричекая кратность собственного значения не превосходит его алгебраической кратности.
\end{follow}
\begin{proof}
    В качестве $W$ возьмем $\Ker(\A - \lambda\mathcal{E}_V)$.
    Очевидно, что собственное подпространство является инвариантным (мы просто умножаем каждый вектор на скаляр, значит остаемся в том же подпространстве).
    Получаем, что $\chi_{\A|_W} | \, \chi_{\A}$

    \quad Заметим, что матрица $[A|_W]_E$ в любом базисе $E$ имеет очень простой вид:
    \begin{gather*}
        \begin{pmatrix}
            \lambda & 0 & \dots & 0 \\
            0 & \lambda & \dots & 0 \\
            \dots & \dots & \dots & \dots \\
            0 & 0 & \dots & \lambda
        \end{pmatrix}
    \end{gather*}
    \quad Отсюда очевидным образом следует, что $\chi_{A|_W} = (\lambda - x)^{g_\lambda}$, так как при подсчете определителя вклад внесет только произведение элементов на главной диагонали, а их $g_\lambda$ штук.
    Получаем, что \[ (\lambda - x)^{g_\lambda} \; | \; \chi_{\A} \Rightarrow \text{имеем как минимум $g_\lambda$ корней $\lambda$} \Rightarrow g_\lambda \leqslant a_\lambda \]
\end{proof}
