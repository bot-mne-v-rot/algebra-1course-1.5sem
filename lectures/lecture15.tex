\section{Лекция номер 15}
\subsection{поля разложения}

\begin{conj}
    Пусть $K$ -- поле, $f \in K[x]$ -- некоторый многочлен, $L/K$ -- расширение. Тогда $L$ называется \textbf{полем разложения} $f$, если:
    \begin{enumerate}
        \item $f$ там раскладывается на линейные множетели. $f = a_0 \cdot (X - x_1) \dots (X - x_n)$ в $L[x]$. 
        \item $L$ получается из $K$ присоединением всех этих корней. $L = K(x_1, \dots, x_n)$. То есть $L$ является наименьшим полем с таким свойством. 
    \end{enumerate}
\end{conj}
Примеры:
\begin{enumerate}
    \item $\Q\left(\sqrt 2\right)$~--- поле разложения $X^2-2$ над $\Q$
    \item $\Q\left(\sqrt[3]{2}\right)$~--- не поле разложения $X^3-2$ над $\Q$ (содержит только один корень)
    \item $\Q\left(\sqrt[3]{2}, \omega\right)$ (где $\omega$~--- какой-то из комплексных корней $X^3-2$)~--- поле разложения $X^3-2$.
    \item $\C$~--- не поле разложения $X^3-2$ над $\Q$ (все корни содержит, но не минимально).
\end{enumerate}

\begin{theorem}
    Пусть $K$ -- поле, $f$ -- его многочлен. Тогда у $f$ существует поле разложения над $K$. 
\end{theorem}
\begin{proof}
    Индукция по степени $f$. 

    \quad \underline{База $f = 1$:} Тогда у него есть единственный корень и он лежит в $K$, то есть $K$ -- само поле разложения. 

    \quad \underline{Переход:} Пусть $f_0$ -- любой неприводимый делитель $f$.
    Возьмем $L := K[X] / (f_0)$, тогда, как мы выясняли ранее, $L=K(x_1)$, где $x_1$~--- некоторый корень $f_0$ и, соответственно, $f$.
    Тогда по теореме Безу в $L$ многочлен $f$ раскладывается как $f=(X-x_1)g$, где $\deg g = \deg f - 1$.
    Тогда по предположению индукции существует поле разложения $g$ в $L$, равное $M=L(x_2, x_3, \ldots, x_n)$, где $x_2,x_3,\ldots, x_n$~--- оставшиеся корни $f$.
    Но тогда $M=L(x_2, x_3, \ldots, x_n) = (K(x_1))(x_2, x_3, \ldots, x_n) = K(x_1, x_2, \ldots, x_n) \Rightarrow$ $M$ является полем разложения $f$ над $K$.
\end{proof}

\subsection{Классификация простых полей}

\begin{conj}
    Поле называется \textbf{простым}, если оно не содержит собственных (т.е. отличных от себя самого) подполей.
\end{conj}

\begin{theorem-non}
    \begin{enumerate}
        \item Любое простое поле изоморфно либо $\Q$, либо $\mathbb{F}_p$
        \item Любое поле содержит единственное простое подполе.
    \end{enumerate}
\end{theorem-non}
\begin{proof}
    Рассмотрим произвольное поле $K$ и гомоморфизм $\varphi$, действующий
    \begin{align*}
        & \qquad \Z \longrightarrow K \\
        & n \mapsto \underbrace{1+1+\cdots+1}_{n \text{ раз}}\quad (\forall n\in \N) \\
        & 0 \mapsto 0 \\
        & -n \mapsto -(\underbrace{1+1+\cdots+1}_{n \text{ раз}})\quad (\forall n\in \N)
    \end{align*}

    Если $\text{char } K = p$, то $\Ker \varphi = p\Z$, отсюда по теореме о гомоморфизме для групп
    \begin{gather*}
        \Z / p\Z \cong \Imm \varphi
    \end{gather*}

    (Теорема дает нам только изоморфизм этих множеств как групп по сложению, однако тривиально проверяется, что $\varphi$ сохраняет умножение, поэтому это еще и изоморфизм колец с $1$).
    При этом мы знаем, что $\Z / p\Z$ является полем, так что $\Imm \varphi$ тоже будет полем, т.е. $\Imm \varphi$~--- подполе в $K$.
    Поэтому если мы (как в пункте $1$) хотим чтобы $K$ было простым, то необходимо $K=\Imm \varphi$
    Если мы (как в пункте $2$) рассматриваем произвольное $K$, то мы нашли его простое подполе.\medskip

    Если теперь $\text{char} K = 0$, то это значит $\Ker \varphi = 0$, что позволяет нам рассмотреть отображение $\varphi'$:
    \begin{gather*}
        \Q \longrightarrow K \\
        \frac mn \mapsto \frac{\varphi'(m)}{\varphi'(n)}
    \end{gather*}

    У него тоже нулевое ядро, поэтому по теореме о гомоморфизме
    \begin{gather*}
        \Q \cong \Imm \varphi'
    \end{gather*}
    При этом $\Q$ является полем $\Rightarrow$ $\Imm \varphi'$ будет подполем в $K$.
    Поэтому если (см. пункт $1$) $K$ простое, то $K=\Imm \varphi'$.
    А если (см. пункт $2$) $K$ произвольное, то мы нашли искомое простое подполе.\medskip

    Осталось проверить, что простое подполе единственно.
    Ну действительно, пусть $F_1, F_2$~--- простые подполя $K$.
    Пересечение полей тоже будет полем, поэтому $F_1 \cap F_2$ будет подполем в $F_1$ и $F_2$.
    Но все их подполя, по определению, собственные, поэтому $F_1 = F_1 \cap F_2 = F_2$.
\end{proof}

Таким образом, у любого поля существует простое подполе, полностью определяемое характеристикой исходного.
Отсюда вытекает

\follow Пусть $K$~--- конечное поле, $\text{char} K = p$. Тогда $|K|=p^n$ для некоторого $n\in\N$.
\begin{proof}
    Из доказательства предыдущей теоремы видно, что $\mathbb{F}_p$ (или изоморфное ему)~--- подполе в $K$.
    Но тогда $K$ можно рассматривать как линейное пространство над $\mathbb{F}_p$.
    Но это и значит, что $|K|=|\mathbb{F}_p|^n=p^n$, где $n = [K:\mathbb{F}_p]$.
\end{proof}

\subsection{Эндоморфизм возведения в степень $p$}
\begin{lemma}
    Пусть $K$~--- поле характеристики $p$.
    Тогда отображение $\varphi: a \mapsto a^p$ является эндоморфизмом (и называется \underline{эндоморфизмом Фробениуса}).
\end{lemma}
\begin{proof}
    Проверяем все необходимые свойства.
    \begin{enumerate}
        \item $\varphi(0)=0, \varphi(1)=1$~--- выполнены
        \item $\varphi(ab) = (ab)^p = a^p \cdot b^p = \varphi(a)\varphi(b)$~--- проверили, что умножение сохраняется
        \item $\varphi(a+b)=\varphi(a)+\varphi(b)$.
        Это неочевидное, но тоже верное свойство: $\varphi(a+b)=(a+b)^p = \sum_{k=0}^p \binom{p}{k} a^k b^{p-k}$.
        Если вспомнить, что $\binom{p}{k} = \frac{p!}{k!(p-k)!}$ и что $p$ простое, то можно заметить, что $p \mid \binom{p}{k}$ при $k\notin \{0, p\}$.
        А поскольку характеристика поля равна $p$, то получается, что $\binom{p}{k}=0$ при всех $k$ кроме $0, p$.
        Так что в сумме остаются только два слагаемых и получается $\varphi(a+b)=(a+b)^p = a^p + b^p = \varphi(a) + \varphi(b)$.
    \end{enumerate}
\end{proof}
\follow Если $K$ конечно, то такое $\varphi$ является автоморфизмом $K$.
\begin{proof}
    Очевидно (например т.к. поле является областью целостности), что $\Ker \varphi = 0$, поэтому $\varphi$ инъективен.
    А т.к. $K$ конечно, то это дает и сюръективность $\Rightarrow$ $\varphi$ биективен, что и означает, что это автоморфизм.
\end{proof}

\subsection{Существование поля из $p^n$ элементов}
Мы поняли, что порядок поля имеет вид $p^n$, где $p\in\mathbb{P}$, $n\in \N$ (см. следствие из пункта про простые поля).
На самом деле, верно и обратное
\begin{theorem-non}
    Пусть $p$ простое, $n$~--- натуральное.
    Тогда существует поле из $p^n$ элементов.
\end{theorem-non}
\begin{proof}
    Для удобства введем $q := p^n$
    Пусть $L$~--- поле разложения многочлена $X^q-X$ над $\mathbb{F}_p$.
    Заметим, что у $X^q-X$ нет кратных корней.
    Действительно, в первом семестре мы проверяли что кратный корень должен быть также корнем формальной производной многочлена.
    Но производная равна $qX^{q-1}-1$.
    Поскольку характеристика поля равна $p$ а $p\mid q$, то первое слагаемое зануляется и остается константная $-1$ $\Rightarrow$ у производной корней нет.

    С другой стороны $X^q-X$ раскладывается на линейные множители в $L$ (ведь это поле разложения).
    Значит, можем рассмотреть множество $M$ корней многочлена $X^q-X$ в $L$ и для него будет верно $|M|=q$.
    Однако $M$ будет являться подполем!
    Проверим это
    \begin{enumerate}
        \item $0,1\in M$~--- очевидно
        \item Замкнутость по умножению: пусть $a, b\in M$, т.е. $a,b$~--- корни $X^q-X$.
        Соответственно, $a^q=a, b^q=b$.
        Тогда $(ab)^q=a^q b^q = ab \Rightarrow$ $ab$ тоже корень $X^q-X$ $\Rightarrow$ $ab\in M$
        \item Замкнутость по сложению: пусть $a, b\in M$, опять же, $a^q=a, b^q=a$.
        Тогда $(a+b)^q = a^q + b^q = a + b$ $\Rightarrow$ $a+b \in M$ (равенство $(a+b)^q = a^q+b^q$ верно по тем же причинам, что и в эндоморфизме Фробениуса. Вообще, возведение в $q$-ю степень равносильно применению $n$ раз эндоморфизма Фробениуса, из этого тоже следует справедливость равенства).
        \item Замкнутость по взятию обратного: пусть $a^q \in M$, т.е. $a^q=a$. Тогда $(a^{-1})^q = (a^q)^{-1}=a^{-1} \Rightarrow a^{-1} \in M$.
        \item Замнкутость по взятию противоположного: пусть $a^q=a$, тогда $(-a)^q = (-1)^q a^q = -1 \cdot a = -a \Rightarrow (-a) \in M$  (Если $p\neq 2$, то $p$ нечетно $\Rightarrow$ $q$ нечетно $\Rightarrow$ $(-1)^q = -1$; если же $p = 2$, то $q$ четно и $(-1)^q=1$, но в поле с характеристикой $2$ $-1=1$, поэтому тоже все хорошо).
    \end{enumerate}\medskip

    Но тогда поле $M$ и является искомым!
    (Более того, поскольку мы выбирали $L$ как поле разложения $X^q-X$, а $M$ уже является полем и содержит все корни, это многочлена, то $L=M$).
\end{proof}

\subsection{Единственность поля из $p^n$ элементов}
\begin{lemma}
    Пусть $L/K$~--- расширение конечных полей.
    Тогда $L/K$ простое (т.е. $L=K(a)$ для некоторого $a\in L$).
\end{lemma}
\begin{proof}
    По теореме (примерно последняя доколлочная теорема) конечная подгруппа мультипликативной группы поля обязана быть циклической.
    Т.е. $L^* = <a>$ для некоторого $a\in L$.
    Но тогда, очевидно, $L=K(a)$.
\end{proof}
\follow $\forall n\in \N$ существует неприводимый многочлен $f$, т.ч. $\deg f = n$.
\begin{proof}
    Рассмотрим поле из $p^n$ элементов.
    Оно является расширением степени $n$ над $\mathbb{F}_p$ и по лемме оно равно $\mathbb{F}_p(a)$.
    Тогда минимальный многочлен элемента $a$ и будет искомым.
\end{proof}
\begin{theorem}(Псевдотеорема Эйлера)
    Пусть $K$~--- поле, $|K|=q<\infty$, $a$~--- произвольный элемент $K$.
    Тогда $a^q=a$.
\end{theorem}
\begin{proof}
    Как мы поняли, $K^* = <d>$ для некоторого $d$.
    Тогда если $a\in K^*$, то $a^{|K^*|}=1$, т.е. $a^{q-1}=1$ (это следствие из теоремы Лагранжа о том, что размер подгруппы делит размер группы~--- см. строение циклических групп), откуда $a^q=a$.
    В противном случае $a=0$ и тогда тоже, очевидно, $a^q=a$.
\end{proof}
\begin{theorem}
    Пусть $p\in \mathbb{P}, n\in \N$, $F_1, F_2$~--- произвольные поля, такие что $|F_1|=|F_2|=p^n$.
    Тогда $F_1\cong F_2$.
\end{theorem}
\begin{proof}
    По лемме, $F_1=\mathbb{F}_p(a)$ для некоторого $a$.
    Пусть $f$~--- минимальный многочлен $a$.
    Рассмотрим многочлен $X^q-X$.
    По псевдотеореме Эйлера все элементы $F_1, F_2$ являются его корнями $\Rightarrow$ и там, и там он раскладывается на линейные множители.
    Более того, $a$ является корнем $X^q-X$, откуда, в силу минимальности $f$, $f \mid (X^q-X)$.
    Значит, $f$ раскладывается на линейные множители в $F_2$.

    Значит, можем рассмотреть $a'$~--- произвольный корень $f$ в $F_2$ (их там даже $n$, подойдет любой).
    Заметим, что $f$ будет минимальным многочленом для $a'$ (действительно, он является зануляющим $\Rightarrow$ должен делиться на минимальный. Но он неприводим $\Rightarrow$ делится только на себя и на $1$, единица очевидно не подходит).
    Рассмотрим теперь $\mathbb{F}_p(a')$.
    Это поле изморфно $\mathbb{F}_p[X] / (f)$, а потому содержит $p^n$ элементов и при этом является подполем в $F_2$, которое тоже состоит из $p^n$ элементов.
    Значит, $F_2 = \mathbb{F}_p(a')$.
    Отсюда окончательно
    \begin{gather*}
        F_1 = \mathbb{F}_p(a) \cong \mathbb{F}_p[X] / (f) \cong \mathbb{F}_p(a') = F_2
    \end{gather*}
\end{proof}