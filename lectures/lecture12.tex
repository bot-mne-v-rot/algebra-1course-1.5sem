\section{Лекция номер 12}
\subsection{Двойственное пространство}
Вспоним, что на прошлой лекции мы ввели понятие двойственного пространства, то есть пространства линейных функционалов на заданном векторном пространстве. 
Оно обозначается так: \[ V^* = \Hom(V, K), \text{ где } V/K - \text{векторное пространство} \]
Одно из его важных свойств заключается в том, что если размерность самого вектороного пространства конечна, то размерность двойственного ему также конечна и даже равна ей: \[ \dim V = n < +\inf \Rightarrow \dim V^* = n \]
Также мы поняли, что по базису $e_1, e_2, \dots e_n$ пространства $V$ можно построить базис $e^1, e^2, \dots e^n$ пространства $V^*$, причем он будет определяться следующим образом: \[ e^i(e_j) = \delta_{ij} \] 
Из равенства размерностей очевидным образом следует изоморфизм пространств $V$ и $V^*$, но никакого выделенного изоморфизма между ними нет, то есть изоморфизм будет зависеть от выбора базиса.
В то же время, если рассматривать дважды двойственное пространство $V^{**} = (V^*)^*$, то оно будет канонически изоморфно $V$. 
Чтобы показать это, заметим, что любой вектор $v \in V$ однозначным образом определяет отображение $\alpha_v$: \begin{gather*}
    \alpha_v: V^* \to K \\
    f \mapsto f(v)
\end{gather*}
Все такие $\alpha_v \in V^{**}$, поэтому можно ввести такое отображение и доказать, что его ядро тривиально (отсюда уже будет следовать, что это изоморфизм, так как размерности равны): \begin{gather*}
    \alpha: V \to V^{**} \\
    v \mapsto \alpha_v
\end{gather*}

\vspace*{7mm}

В общем и целом, дважды двойственные пространства нам не очень интересны, поэтому вернемся к просто двойственным пространствам.
Оказывается, что если рассматривать евклидовы или унитарные пространства, то канонический изоморфизм там все-таки найдется.

Пусть $V$ -- евклидово пространство, $w \in V$. 
Тогда отображение $l_w \in V^*$: \begin{gather*}
    l_w: V \to K \\
    v \mapsto (v, w)
\end{gather*} 

\begin{theorem-non}
    Данное отображение $l$ -- изоморфизм линейных пространств: \begin{gather*}
        l: V \to  V^* \\
        w \mapsto  l_w
    \end{gather*}
\end{theorem-non}
\begin{proof}
    Размерности у этих пространств одинаковы, поэтому достаточно проверить либо инъективность, либо сюръективность.
    Будем проверять инъективность, а именно тривиальность ядра. Пусть $w \in \Ker l$. Это означает, что $\forall v \in V \; (v, w) = 0$, в частности $(w, w) = 0$, а это равносильно тому, что $w = 0$.
\end{proof}

\vspace*{7mm}

Теперь посмотрим на ту же конструкцию в унитарном пространстве.
Пусть $V$ -- унитарное пространство, $w \in V$. 
Тогда отображение $l_w \in V^*$ (это действительно так, ведь скалярное произведение в унитарном пространстве от первого аргумента зависит линейно): \begin{gather*}
    l_w: V \to K \\
    v \mapsto (v, w)
\end{gather*}
\begin{theorem-non}
    Данное отображение $l$ -- полулинейная биекция: \begin{gather*}
        l: V \to V^* \\
        w \mapsto l_w
    \end{gather*}
    Свойства полулинейности: \begin{enumerate}
        \item $l(w_1 + w_2) = l(w_1) + l(w_2)$
        \item $l(\alpha w) = \bar{\alpha}\, l(w)$
    \end{enumerate}
\end{theorem-non}
\begin{proof}
    Полулинейность очевивдна. 
    Ядро тривиально аналогично предыдущему предложению. 
    Но опустить доказательство сюръективности, сославшись на равенство размерностей, мы уже не можем, так как соотнешение размерностей ядра и образа работает только для линейных отображений.
    Поэтому докажем сюръективность с помощью следующего трюка.

    Введем векторное пространство $\tilde{V}$, которое будет совпадать с $V$ за исключением операции умножения.
    Для $\tilde{V}$ она будет определена как $\alpha \cdot v := \bar{\alpha}v$. 
    Мы можем записать следующую цепочку отображений: \[ \tilde{V} \overset{id}{\to} V \overset{l}{\to} V^* \]
    Они оба полулинейны, следовательно $l \circ id$ линейно. 
    Поэтому к нему мы можем применить предыдущие соображения: \[ \Ker(l \circ id) = \Ker l = 0 \Rightarrow \Imm(l \circ id) = V^* \Rightarrow \Imm l = V^*  \]
    Таким образом, $l$ сюръективно.
\end{proof}

\begin{notice}
    \[ e_1, e_2, \dots, e_n - \text{ ортонормированный базис } \Rightarrow le_1, le_2, \dots, le_n - \text{двойственный базис} \]
    Действительно, из-за ортонормированности отображения (они же скалярные произведения) будут действовать как надо.
\end{notice}

\subsection{Сопряженный оператор}
Пусть $V$ -- конечномерное евклидово или унитарное пространство, $\A \in \End V$ -- линейный оператор, $w \in V$ -- вектор из $V$.
Заметим, что данное отображение $h$ будет принадлежать $V^*$: \begin{gather*}
    h: V \to K \\
    v \mapsto (\A v, w)
\end{gather*}
Из предыдущего параграфа мы поняли, что любое отображение из $V^*$, где $V$ -- евклидово или унитарное пространство, может быть описано скалярным умножением на какой-то $w'$ (причем такой $w'$ уникален): \begin{gather*}
    \exists \; ! \, w' \in V : \quad \forall v \in V \;\;\; (v, w') = (\A v, w)
\end{gather*} 
Каждому $w$ однозначно сопоставляется $w'$, то есть мы получили отображение $V$ в себя: \begin{gather*}
    \A^*: V \to V \\
    w \mapsto w'
\end{gather*}

Теперь определим формально понятие сопряженного оператора.
\begin{conj}
    Оператор $\A^*$ называется сопряженным к $\A$, если $\forall v, w \in V$ выполнено $(\A v, w) = (v, \A^*w)$.
\end{conj}

\vspace*{5mm}

Докажем, что это действительно линейный оператор.

\begin{theorem-non}
    $\A^*$ -- линейный оператор на $V$.
\end{theorem-non}
\begin{proof} \quad 

    \quad Проверим сложение: \begin{gather*}
        \begin{split}
            \forall v \in V \quad (v, \A^*(w_1 + w_2)) &= (\A v, w_1 + w_2) \\
            &= (\A v, w_1) + (\A v, w_2) \\
            &= (v, \A^* w_1) + (v, \A^* w_2) \\
            &= (v, \A^* w_1 + \A^* w_2)         
        \end{split}\\ \Rightarrow \A^*(w_1 + w_2) = \A^* w_1 + \A^* w_2
    \end{gather*}
    \quad Проверим умножение на скаляр: \begin{gather*}
        \begin{split}
            \forall v \in V \quad (v, \A^*(\alpha w)) &= (\A v, \alpha w) \\
            &= \bar{\alpha}(\A v, w) \quad (\text{для евкл. пр-ва сопряжение тоже корректно,} \\
            &= \bar{\alpha}(v, \A^* w) \quad \text{т.к. ничего не меняет)}\\
            &= (v, \alpha \, \A^* w)
        \end{split} \\ \Rightarrow \A^*(\alpha w) = \alpha \, \A^* w
    \end{gather*}
\end{proof}

\vspace*{5mm}

\begin{theorem-non}
    Свойства сопряженного оператора:
    \begin{enumerate}
        \item $(\A^*)^* = \A$
        \item $(\A + \B)^* = \A^* + \B^*$
        \item $(\alpha \A)^* = \bar{\alpha} \A^*$
        \item $(\A\B)^* = \B^*\A^*$
    \end{enumerate}
\end{theorem-non}
\begin{proof} \quad

    \begin{enumerate}
        \item Достаточно проверить, что $(\A^*v, w) = (v, \A w)$. Тут надо воспользоваться эрмитовостью, чтобы поменять порядок: $(\A^*v, w) = \overline{(w, \A^*v)}$ и $(v, \A w) = \overline{(\A w, v)}$. Легко видеть, что части под сопряжением равны, следовательно, равны и изначальные выражения.
        \item Достаточно проверить, что $((\A + \B)v, w) = (v, (\A^* + \B^*)w)$. Это очевидно из соображений линейности.
        \item Аналогично пункту 2.
        \item Достаточно проверить, что $((\A\B)v, w) = (v, (\B^*\A^*)w)$. Это действительно так, ведь $((\A\B)v, w) = (\A(\B v), w) = (\B v, \A^*w) = (v, \B^*\A^*w)$.
    \end{enumerate}
\end{proof}

Посчитаем матрицу сопряженного оператора. Это удобно делать в ортонормированном базисе.
\begin{theorem-non}
    Пусть $E$ -- ортонормированный базис $V$, $\A \in \End V$, $[\A]_E = A$.
    Тогда $[\A^*]_E = A^*$.
\end{theorem-non}
\begin{proof}
    Для удобства будем обозначать $A$ как $(a_{ij})$, а $[\A^*]_E$ как $(b_{ij})$.
    Посмотрим на $j$-тый столбец матрицы $A$: $\A e_j = a_{1j}e_1 + \dots + a_{nj}e_n$.
    Умножим его скалярно на $e_i$: вследствие ортонормированности получаем $(\A e_j, e_i) = a_{ij}$. 
    Воспользуемся сопряженным оператором: $(\A e_j, e_i) = (e_j, \A^* e_i) = a_{ij}$. 
    Заметим, что $\A^* e_i$ -- это $i$-тый столбец $A^*$, значит при скалярном умножении сократится почти все, кроме коэффициента $b_{ji}$, который вынесется с комплексным сопряжением (так как взят из правой части).
    Итого $a_{ij} = \bar{b}_{ji}$ для любых $i, j$, следовательно $[\A^*]_E = A^*$.
\end{proof}

\subsection{Нормальные операторы}

\begin{conj}
    Оператор $\A$ называется нормальным, если он коммутирует со своим сопряженным: $\A\A^* = \A^*\A$.
\end{conj}
Выделим два важных частных случая нормальных операторов:
\begin{enumerate}
    \item $\A = \A^*$ -- самосопряженные операторы.
    \item $\A^{-1} = \A^*$ -- ортогональные (для евклидова пр-ва) или унитарные (для унитарного пр-ва) операторы.
\end{enumerate}

Докажем пару предложений, необходмых для доказательства важной теоремы о диагональной матрице оператора.
Здесь будем считать, что $V$ евклидово или унитарное.

\begin{theorem-non}
    Пусть $\A \in \End V$ и $W \subset V$ инвариантно относительно $\A$. 
    Тогда $W^\perp$ инвариантно относительно $\A^*$.
\end{theorem-non}
\begin{proof}
    Пусть $w' \in W^\perp$ и $w \in W$. Тогда: \[ (w, \A^*w') = (\underbrace{\A w}_{\in W}, w') = 0 \Rightarrow \A^*w' \in W^\perp \]
\end{proof}

\begin{theorem-non}
    Пусть $\A \in \End V$ -- нормальный, $\alpha \in \mathbb{C}$ (для евклидова случая $\R$). Тогда $\B = \A - \alpha \mathcal{E}$ -- нормальный.
\end{theorem-non}

\begin{proof}
    \begin{gather*}
        \B\B^* = (\A - \alpha\mathcal{E})(\A^* - \bar{\alpha}\mathcal{E}) = \A\A^* - \alpha\A^* - \bar{\alpha}\A + |\alpha|^2\mathcal{E} \\
        \B^*\B = (\A^* - \bar{\alpha}\mathcal{E})(\A - \alpha\mathcal{E}) = \underbrace{\A^*\A}_{= \A\A^*} - \alpha\A^* - \bar{\alpha}\A + |\alpha|^2\mathcal{E} \\
    \end{gather*}
\end{proof}

\begin{theorem-non}
    Пусть $\A \in \End V$ -- нормальный, $v$ -- собственный вектор $\A$, соотвествующий собственному значению $\lambda$.
    Тогда $v$ -- собственный вектор $\A^*$, соотвествующий собственному значению $\bar{\lambda}$.
\end{theorem-non}

\begin{proof}
    Введем $\B = \A - \lambda \mathcal{E}$. Заметим, что по предыдущему предложению этот оператор нормальный.
    По определению собственного вектора $\B v = 0$. Тогда $(\B v, \B v) = 0$, но мы также можем переписать это следующим образом:
    \begin{gather*}
        0 = (\B v, \B v) = (v, \B^*\B v) = (v, \B\B^* v) = (\B^*v, \B^*v) \\
        \Rightarrow \B^* v = 0 \Rightarrow (\A^* - \bar{\lambda}\mathcal{E})v = 0 \Rightarrow \A^* v = \bar{\lambda}v
    \end{gather*}
\end{proof}

\begin{theorem}
    Пусть $V$ -- унитарное пространство, $\A \in \End V$ -- нормальный. 
    Тогда в $V$ есть ортонормированный базис $E$ такой, что $[\A]_E$ -- диагональная.
\end{theorem}
\begin{proof}
    Индукция по $n = \dim V$.
    \begin{itemize}
        \item База $n = 1$ тривиальна. Возьмем любой вектор и отнормируем его, матрица будет диагональной.
        \item Переход $n - 1 \to n$. 
        Так как $V$ -- унитарное, характеристический многочлен $\chi_{\A}$ раскладывается на линейный множители. 
        Возьмем любой из его корней, это будет какое-то собственное значение, и возьмем любой нормированный вектор, принадлежащий этому собственному значению. 
        Обозначим этот вектор за $e_1$. 

        Воспользуемся первым предложением: так как $\Lin(e_1)$ была $\A$-инвариантна (ведь $e_1$ собственный), $W := \Lin(e_1)^\perp$ будет $\A^*$-инвариантна.
        Согласно третьему предложению, $e_1$ будет также собственным вектором $\A^*$, значит, он будет $\A^*$-инвариантен, значит, $W$ будет $\A$-инвариантно.

        Так как $W$ будет и $\A$-инвариантно, и $\A^*$-инвариантно, операторы $\A$ и $\A^*$ останутся сопряженными при сужении на $W$: $(\A\big|_W)^* = \A^*\big|_W$. 
        Значит, они все еще будут нормальными, и мы можем применить к $W$ индукционное предположение: $\dim W = n - 1 \Rightarrow$ найдется ортонормированный базис $e_2, \dots, e_n$ с диагональной матрицей.
        Тогда базис $e_1, e_2, \dots, e_n$ -- искомый, потому что матрица очевидно будет диагональной ($e_1$ собственный), $e_1$ нормированный и ортогональный $e_2, \dots, e_n$.
    \end{itemize}
\end{proof}

В наших двух важных частных случаях матрица будет не только диагональной.

\begin{follow}
    \begin{enumerate}
        \item Пусть $V$ -- унитарное, $\A \in \End V$. Тогда эквивалентны: \begin{enumerate}
            \item $\A = \A^*$
            \item В $V$ существует такой ортонормированный базис $E$, что $[\A]_E$ диагональна и вещественна. 
        \end{enumerate}
        \begin{proof} 
            $1 \Rightarrow 2:$ Для ортонормированного базиса верно, что $[\A^*]_E = A^*$.
            По условию $[\A^*]_E = [\A]_E = A$. Следовательно, $A = A^*$ и на диагонали стоят вещественные числа.

            $2 \Rightarrow 1:$ $A = [\A]_E$ диагональна и вещественна. Тогда $A^* = A$ и $[\A^*]_E = [\A]_E$. 
            Раз матрицы операторов совпадают в каком-то базисе, совпадают и сами операторы, то есть $\A = \A^*$.
        \end{proof}
        \item Пусть $V$ -- унитарное, $\A \in \End V$. Тогда эквивалентны: \begin{enumerate}
            \item $\A$ унитарный
            \item В $V$ существует такой ортонормированный базис $E$, что $[\A]_E$ диагональна, и все числа на диагонали по модулю равны 1. 
        \end{enumerate}
        \begin{proof}
            Аналогично, только меняется ключевое свойство:
            \begin{gather*}
                \begin{split}
                    \A - \text{унитарный} &\Leftrightarrow AA^* = E_n \\
                    &\Leftrightarrow diag(z_1, \dots, z_n) * diag(\bar{z_1}, \dots, \bar{z_n}) = E_n \\
                    &\Leftrightarrow z_i\bar{z_i} = 1 \;\; \forall i = 1, \dots, n \\
                    &\Leftrightarrow |z_i|^2 = 1  \;\; \forall i = 1, \dots, n
                \end{split}
            \end{gather*}
        \end{proof}
    \end{enumerate}
\end{follow}

Ну и напоследок еще одно левое предложение.

\begin{theorem-non}
    Собственные векторы, принадлежащие различным собственным значениям нормального оператора, ортогональны друг другу.
\end{theorem-non}
\begin{proof}
    Пусть $\A v = \lambda v, \A w = \mu w$, где $\lambda \neq \mu$. Тогда \begin{gather*}
        (\A v, w) = (\lambda v, w) = \lambda (v, w) \\
        (\A v, w) = (v, \A^* w) = (v, \bar{\mu} w) = \mu (v, w) \\
        \Rightarrow \lambda (v, w) = \mu (v, w) \Rightarrow (v, w) = 0
    \end{gather*}
\end{proof}